<!-- 
  顶部促销横幅 - 英文首页专用
  功能：点击打开 Elementor 访谈表单弹窗
  弹窗 ID: 12817
-->

<div id="pangolin-top-banner" class="pangolin-promo-banner">
    <div class="banner-content">
        <span class="banner-text">
            Discover the New Pangolin Version — Join a 30-min interview & get
            <strong class="highlight">50% OFF for life</strong>.
        </span>
        <button class="banner-close" aria-label="Close banner">×</button>
    </div>
</div>

<style>
    /* 顶部促销横幅样式 */
    .pangolin-promo-banner {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        width: 100%;
        height: 40px;
        background-color: #F8F8F8;
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .pangolin-promo-banner:hover {
        background-color: #F0F0F0;
    }

    .pangolin-promo-banner .banner-content {
        max-width: 1200px;
        width: 100%;
        padding: 0 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }

    .pangolin-promo-banner .banner-text {
        font-size: 14px;
        line-height: 1.5;
        color: #333333;
        text-align: center;
        font-weight: 400;
    }

    .pangolin-promo-banner .banner-text .highlight {
        color: #0066FF;
        font-weight: 600;
    }

    .pangolin-promo-banner .banner-close {
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        background: transparent;
        border: none;
        font-size: 24px;
        line-height: 1;
        color: #666;
        cursor: pointer;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: color 0.2s ease;
    }

    .pangolin-promo-banner .banner-close:hover {
        color: #333;
    }

    /* 为页面主体添加顶部间距，避免被横幅遮挡 */
    body.has-top-banner {
        padding-top: 40px !important;
    }

    /* 响应式设计 */
    @media (max-width: 768px) {
        .pangolin-promo-banner {
            height: auto;
            min-height: 40px;
            padding: 8px 0;
        }

        .pangolin-promo-banner .banner-text {
            font-size: 12px;
            padding-right: 30px;
        }

        .pangolin-promo-banner .banner-close {
            right: 10px;
            font-size: 20px;
        }

        body.has-top-banner {
            padding-top: 56px !important;
        }
    }

    @media (max-width: 480px) {
        .pangolin-promo-banner .banner-text {
            font-size: 11px;
            line-height: 1.4;
        }
    }

    /* 横幅关闭后的状态 */
    .pangolin-promo-banner.banner-closed {
        display: none;
    }

    body.banner-closed {
        padding-top: 0 !important;
    }
</style>

<script>
    (function () {
        // 等待 DOM 加载完成
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initBanner);
        } else {
            initBanner();
        }

        function initBanner() {
            var banner = document.getElementById('pangolin-top-banner');
            if (!banner) return;

            // 添加 body class
            document.body.classList.add('has-top-banner');

            // 点击横幅（除了关闭按钮）打开弹窗
            banner.addEventListener('click', function (e) {
                if (e.target.classList.contains('banner-close')) {
                    return; // 点击关闭按钮时不打开弹窗
                }

                // 打开 Elementor 弹窗
                if (typeof elementorProFrontend !== 'undefined') {
                    elementorProFrontend.modules.popup.showPopup({ id: 12817 });
                } else {
                    console.log('[Banner] Elementor Pro 未加载，无法打开弹窗');
                }
            });

            // 关闭按钮功能
            var closeBtn = banner.querySelector('.banner-close');
            if (closeBtn) {
                closeBtn.addEventListener('click', function (e) {
                    e.stopPropagation(); // 阻止事件冒泡
                    closeBanner();
                });
            }

            // 关闭横幅
            function closeBanner() {
                banner.classList.add('banner-closed');
                document.body.classList.remove('has-top-banner');
                document.body.classList.add('banner-closed');

                // 保存关闭状态到 localStorage（24小时内不再显示）
                var expireTime = new Date().getTime() + (24 * 60 * 60 * 1000);
                localStorage.setItem('pangolin_banner_closed', expireTime);
            }

            // 检查是否已关闭
            var closedTime = localStorage.getItem('pangolin_banner_closed');
            if (closedTime && new Date().getTime() < parseInt(closedTime)) {
                closeBanner();
            }
        }
    })();
</script>